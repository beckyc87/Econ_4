---
title: "Econ Assignment 4 Carbon"
author: "Becky Clow"
date: "5/29/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}

library(tidyverse)
library(reshape2)

carbon_abate <- read_csv("HW4Data.csv") %>% 
  mutate(demandA = A_demand(x = Abatement)) %>% 
  mutate(demandB = B_demand(x = Abatement)) %>% 
  mutate(demandC = C_demand(x = Abatement)) %>%
  mutate(demandD = D_demand(x = Abatement)) 

carbon_tidy <- melt(carbon_abate[c('Abatement',  'MC_A', 'MC_B', 'MC_C', 'MC_D')], id.vars = 1) %>% rename(quantity = Abatement,
         sector = variable, 
         price = value)
  
```

```{r}
#Visualize the data

sector_A <- ggplot(carbon_abate, aes(x = Abatement, y = MC_A)) +
  geom_point()
sector_A

sector_B <- ggplot(carbon_abate, aes(x = Abatement, y = MC_B)) +
  geom_point()
sector_B

sector_C <- ggplot(carbon_abate, aes(x = Abatement, y = MC_C)) +
  geom_point()
sector_C

sector_D <- ggplot(carbon_abate, aes(x = Abatement, y = MC_D)) +
  geom_point()
sector_D


```


1. Write down a plausible functional form for the marginal cost of abatement for sector A. Use regression analysis to estimate the parameters of that function. Repeating this for sectors B, C, and D will give you a model of the marginal cost of abatement function for each sector. How well do your models fit the data for each sector? You may need to experiment with different functional forms. Produce a plot of the estimated marginal abatement cost functions in all four sectors (this plot should go in your memo).

```{r}
#Linear Models for each sector

model_A <- lm(MC_A ~ Abatement, data = carbon_abate)
summary(model_A)

model_B <- lm(MC_B ~ Abatement, data = carbon_abate)
summary(model_B)

model_C <- lm(MC_C ~ Abatement, data = carbon_abate)
summary(model_C)

model_D <- lm(MC_D ~ Abatement, data = carbon_abate)
summary(model_D)

#Marginal cost of abatement graphs

mc_graph <- ggplot(carbon_tidy, aes(x = price, y = quantity)) +
  geom_point(aes(color = sector))+
  facet_wrap(~sector)+
  geom_smooth(method = lm, se = FALSE, size = 0.5, color = "gray20") +
  theme_classic()
mc_graph



```


##Supply graph with Demand and supply
```{r}
#Graph sector A
A_graph <- ggplot(carbon_abate) +
  geom_smooth(aes(x = Abatement, y = MC_A), method = lm, se = FALSE, size = 0.5, color = "gray20") +
  geom_smooth(aes(x = demandA, y = MC_A), method = lm, se = FALSE, size = 0.5, color = "gray20") +
  theme_classic()+
  labs(title = "Sector A", 
       x = "Carbon Emissions (Tons)",
       y = "Price ($/ton)") +
  scale_y_continuous(expand = c(0,0), limits = c(0,120)) +
  scale_x_continuous(expand = c(0,0), limits = c(0,160))
A_graph

#Graph sector B
B_graph <- ggplot(carbon_abate) +
  geom_smooth(aes(x = Abatement, y = MC_B), method = lm, se = FALSE, size = 0.5, color = "gray20") +
  geom_smooth(aes(x = demandB, y = MC_B), method = lm, se = FALSE, size = 0.5, color = "gray20") +
  theme_classic()+
  labs(title = "Sector B", 
       x = "Carbon Emissions (Tons)",
       y = "Price ($/ton)") +
  scale_y_continuous(expand = c(0,0), limits = c(0,120)) +
  scale_x_continuous(expand = c(0,0), limits = c(0,160))
B_graph

C_graph <- ggplot(carbon_abate) +
  geom_smooth(aes(x = Abatement, y = MC_C), method = lm, se = FALSE, size = 0.5, color = "gray20") +
  geom_smooth(aes(x = demandC, y = MC_C), method = lm, se = FALSE, size = 0.5, color = "gray20") +
  theme_classic()+
  labs(title = "Sector C", 
       x = "Carbon Emissions (Tons)",
       y = "Price ($/ton)") +
  scale_y_continuous(expand = c(0,0), limits = c(0,120)) +
  scale_x_continuous(expand = c(0,0), limits = c(0,160))
C_graph

D_graph <- ggplot(carbon_abate) +
  geom_smooth(aes(x = Abatement, y = MC_D), method = lm, se = FALSE, size = 0.5, color = "gray20") +
  geom_smooth(aes(x = demandD, y = MC_D), method = lm, se = FALSE, size = 0.5, color = "gray20") +
  theme_classic()+
  labs(title = "Sector D", 
       x = "Carbon Emissions (Tons)",
       y = "Price ($/ton)") +
  scale_y_continuous(expand = c(0,0), limits = c(0,120)) +
  scale_x_continuous(expand = c(0,0), limits = c(0,160))
D_graph

```


2. Using these models and the current level of carbon emissions, derive each sector’s demand curve for carbon emissions. In other words, how much would each sector be willing to pay for the right to pollute the first unit, second unit, etc? Draw these demand curves on a graph. Which sector is willing to pay the most for the first unit of carbon emissions?

```{r}
#determine demand curves

A<-180
B<-200
C<-220
D<-300

#calculating the y-intercept of demand
A_demand_int <- (model_A$coefficients[1] + model_A$coefficients[2]*A)
A_demand_int

B_demand_int <- (model_B$coefficients[1] + model_B$coefficients[2]*B)
B_demand_int

C_demand_int <- (model_C$coefficients[1] + model_C$coefficients[2]*C)
C_demand_int

D_demand_int <- (model_D$coefficients[1] + model_D$coefficients[2]*D)
D_demand_int

#slope of demand

A_slope <- (A_demand_int/-A)
A_slope

B_slope <- (B_demand_int/-B)
B_slope

C_slope <- (C_demand_int/-C)
C_slope

D_slope <- (D_demand_int/-D)
D_slope

```

```{r}
#Demand curves
#demand price = slope*x + intercept

A_demand <- function(x) {
  Demand = (A_slope)*x + A_demand_int
}

B_demand <- function(x) {
  Demand = (B_slope)*x + B_demand_int
}

C_demand <- function(x) {
  Demand = (C_slope)*x + C_demand_int
}

D_demand <- function(x) {
  Demand = (D_slope)*x + D_demand_int
}


#create a dataframe, Not applicable anymore
#A_price <- c(A_demand_int)
#A_carbon <- c(A)
#A_dataframe <- data.frame(A_carbon, A_price)

#A_demand <- lm(A_price ~ A_carbon, data = A_dataframe)
#summary(A_demand)


```



3. Now focus on country X (which contains sectors A, B, and C). Assume there are no “co-benefits” from carbon abatement (i.e. that there are no local pollutants that are affected by carbon abatement). Suppose to meet the Paris Accord commitments, country X needs to cut all carbon emissions in half. For each of the policy options listed below, derive: (1) the total cost of meeting the target in country X, (2) the cost (or benefit) to each sector, and (3) the tax revenue generated.
    a. Cap on carbon. Each sector (A, B, and C) must cut its carbon emissions by 100 tons (thus reducing total      emissions from 600 down to 300).
    b. Tax on carbon. To emit a ton of carbon in country X, you must pay a tax of $t. You will need to find the     tax that accomplishes the desired reduction.
    c. Cap and trade. Each sector (A, B, C) is allocated carbon permits equal to their current emissions minus      100 (same as in (a) above), thus achieving the total reduction of 300. Then, these three sectors are allowed     to trade with each other. You will need to derive the outcome of that trading.
    
    
4. Again, without any co-benefits, suppose that country Y (which only has one carbon-emitting sector, D) has no obligation to reduce its emissions. Country X asks country Y to enter the country X carbon market. Doing so would require country Y to put a cap on carbon emissions at its current level of emissions (300 tons), but would then allow country Y to sell carbon offsets to sectors A, B, or C. Are there any incentives for country Y to enter country X’s carbon market and to thus place a voluntary cap on its emissions? Are there any incentives for country X to try to attract country Y into its market?


5. Now assume that every ton of carbon emissions creates 1 ton of local air pollution. Local air pollution causes economic damages (health, environmental, etc.), but only in the country in which it is emitted. Assume there are no local air pollution regulations in either country X or country Y.
    a. In a carbon cap and trade market that only covers sectors in country X, how much local air pollution         would you expect in country X? In country Y?
    b. If country Y enters the carbon market for country X (as in question 4 above), how much local pollution       will there be in country X and country Y?
    c. What advice can you give country X and country Y about the desirability of allowing international trade      of carbon emissions credits?
    
    